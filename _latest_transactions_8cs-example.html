<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>AcUtils: LatestTransactions.cs</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="Doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Verizon.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">AcUtils
   </div>
   <div id="projectbrief">A high performance abstraction layer for AccuRev</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="usergroup0.html"><span>Docs</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="group__acenum.html"><span>Enums</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">LatestTransactions.cs</div>  </div>
</div><!--header-->
<div class="contents">
<p>Generates an Excel worksheet with the latest transactions for all depots. The list is in reverse chronological order so the most recent activity in the repository is shown on top. Change <em>FileName</em> and <em>FileLocation</em> in <code>LatestTransactions.exe.config</code> to specify the name and location of the resultant Excel file. <em>FileLocation</em> must be an existing folder with read/write access privileges. The program uses MS Office interop so Excel must be installed. [Tested with Excel 2010.]</p>
<dl class="section user"><dt>LatestTransactions.exe.config</dt><dd></dd></dl>
<div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;utf-8&quot;</span>?&gt;</div>
<div class="line">&lt;configuration&gt;</div>
<div class="line">  &lt;appSettings&gt;</div>
<div class="line">    &lt;add key=<span class="stringliteral">&quot;FileName&quot;</span> value=<span class="stringliteral">&quot;LatestTransactions.xlsx&quot;</span>/&gt;</div>
<div class="line">    &lt;!-- FileLocation must be an existing folder with read/write access privileges --&gt;</div>
<div class="line">    &lt;add key=<span class="stringliteral">&quot;FileLocation&quot;</span> value=<span class="stringliteral">&quot;C:\Bin&quot;</span>/&gt;</div>
<div class="line">  &lt;/appSettings&gt;</div>
<div class="line">  &lt;system.diagnostics&gt;</div>
<div class="line">    &lt;assert assertuienabled=<span class="stringliteral">&quot;false&quot;</span>/&gt;</div>
<div class="line">    &lt;sources&gt;</div>
<div class="line">      &lt;source name=<span class="stringliteral">&quot;LatestTransactions&quot;</span>&gt;</div>
<div class="line">        &lt;listeners&gt;</div>
<div class="line">          &lt;<span class="keyword">remove</span> name=<span class="stringliteral">&quot;Default&quot;</span>/&gt;</div>
<div class="line">          &lt;add name=<span class="stringliteral">&quot;AcLog&quot;</span> type=<span class="stringliteral">&quot;Microsoft.VisualBasic.Logging.FileLogTraceListener, Microsoft.VisualBasic, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL&quot;</span>/&gt;</div>
<div class="line">        &lt;/listeners&gt;</div>
<div class="line">      &lt;/source&gt;</div>
<div class="line">    &lt;/sources&gt;</div>
<div class="line">  &lt;/system.diagnostics&gt;</div>
<div class="line">  &lt;startup&gt;</div>
<div class="line">    &lt;supportedRuntime version=<span class="stringliteral">&quot;v4.0&quot;</span> sku=<span class="stringliteral">&quot;.NETFramework,Version=v4.6.1&quot;</span>/&gt;</div>
<div class="line">  &lt;/startup&gt;</div>
<div class="line">&lt;/configuration&gt;</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">/* Copyright (C) 2017-2018 Verizon. All Rights Reserved.</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></div>
<div class="line"><span class="comment">you may not use this file except in compliance with the License.</span></div>
<div class="line"><span class="comment">You may obtain a copy of the License at</span></div>
<div class="line"><span class="comment">    http://www.apache.org/licenses/LICENSE-2.0</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">Unless required by applicable law or agreed to in writing, software</span></div>
<div class="line"><span class="comment">distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></div>
<div class="line"><span class="comment">WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div>
<div class="line"><span class="comment">See the License for the specific language governing permissions and</span></div>
<div class="line"><span class="comment">limitations under the License. */</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// Required references: AcUtils.dll, Microsoft.CSharp, Microsoft.Office.Interop.Excel, System, System.configuration, System.Windows.Forms, System.Xml.Linq</span></div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Collections.Generic;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Configuration;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Diagnostics;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.IO;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Linq;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Runtime.InteropServices;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.<a class="code" href="namespace_system_1_1_threading.html">Threading</a>.<a class="code" href="namespace_system_1_1_threading_1_1_tasks.html">Tasks</a>;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Windows.Forms;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Xml.Linq;</div>
<div class="line"><span class="keyword">using</span> Excel = Microsoft.Office.Interop.Excel;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespace_ac_utils.html">AcUtils</a>;</div>
<div class="line"></div>
<div class="line"><span class="keyword">namespace </span>LatestTransactions</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">class </span>Program</div>
<div class="line">    {</div>
<div class="line"><span class="preprocessor">        #region class variables</span></div>
<div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> List&lt;string&gt; _depots; <span class="comment">// names of all depots in repository</span></div>
<div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> List&lt;XElement&gt; _transactions; <span class="comment">// latest transaction in each depot</span></div>
<div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">string</span> _fileName; <span class="comment">// from LastestTransactions.exe.config</span></div>
<div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">string</span> _fileLocation; <span class="comment">// .. </span></div>
<div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> readonly <span class="keywordtype">object</span> _locker = <span class="keyword">new</span> object();  <span class="comment">// token for lock keyword scope</span></div>
<div class="line"><span class="preprocessor">        #endregion</span></div>
<div class="line"></div>
<div class="line">        [STAThread]</div>
<div class="line">        <span class="keyword">static</span> <span class="keywordtype">int</span> Main(<span class="keywordtype">string</span>[] args)</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// general program initialization</span></div>
<div class="line">            <span class="keywordflow">if</span> (!init()) <span class="keywordflow">return</span> 1;</div>
<div class="line"></div>
<div class="line">            _transactions = <span class="keyword">new</span> List&lt;XElement&gt;(_depots.Count);</div>
<div class="line">            <span class="keywordflow">if</span> (initTransListAsync().Result == <span class="keyword">false</span>) <span class="keywordflow">return</span> 1;</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">return</span> report() ? 0 : 1;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Initialize our transactions list with the latest transactions for all depots in the repository.</span></div>
<div class="line">        <span class="comment">// Returns true if initialization succeeded, otherwise false.</span></div>
<div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> async Task&lt;bool&gt; initTransListAsync()</div>
<div class="line">        {</div>
<div class="line">            List&lt;Task&lt;bool&gt;&gt; tasks = <span class="keyword">new</span> List&lt;Task&lt;bool&gt;&gt;(_depots.Count);</div>
<div class="line">            <span class="keywordflow">foreach</span> (<span class="keywordtype">string</span> <a class="code" href="namespace_ac_utils.html#ga40cba942bbed1ac998223575478e4d6fa6f13b876f224fb5d11c729c36a871540">depot</a> <span class="keywordflow">in</span> _depots)</div>
<div class="line">                tasks.Add(initLastTransAsync(depot));</div>
<div class="line"></div>
<div class="line">            <span class="keywordtype">bool</span>[] arr = await Task.WhenAll(tasks); <span class="comment">// finish running all in parallel</span></div>
<div class="line">            <span class="keywordflow">return</span> (arr != null &amp;&amp; arr.All(n =&gt; n == <span class="keyword">true</span>)); <span class="comment">// true if all succeeded</span></div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Run the hist command for depot and add the results to our transactions list. Returns </span></div>
<div class="line">        <span class="comment">// true if operation succeeds, otherwise false. AcUtilsException caught and logged in </span></div>
<div class="line">        <span class="comment">// %LOCALAPPDATA%\AcTools\Logs\LatestTransactions-YYYY-MM-DD.log on hist command failure.</span></div>
<div class="line">        <span class="comment">// Exception caught and logged in same for a range of exceptions.</span></div>
<div class="line">        <span class="keyword">private</span> async <span class="keyword">static</span> Task&lt;bool&gt; initLastTransAsync(<span class="keywordtype">string</span> depot)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">bool</span> ret = <span class="keyword">false</span>; <span class="comment">// assume failure</span></div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                AcResult r = await AcCommand.runAsync($<span class="stringliteral">@&quot;hist -p &quot;&quot;{depot}&quot;&quot; -t now -fx&quot;</span>);</div>
<div class="line">                <span class="keywordflow">if</span> (r != null &amp;&amp; r.RetVal == 0)</div>
<div class="line">                {</div>
<div class="line">                    XElement xml = XElement.Parse(r.CmdResult);</div>
<div class="line">                    XElement trans = xml.Element(<span class="stringliteral">&quot;transaction&quot;</span>);</div>
<div class="line">                    trans.AddAnnotation(depot); <span class="comment">// add depot since it&#39;s not in the XML</span></div>
<div class="line">                    lock (_locker) { _transactions.Add(trans); }</div>
<div class="line">                    ret = <span class="keyword">true</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">catch</span> (AcUtilsException exc)</div>
<div class="line">            {</div>
<div class="line">                AcDebug.Log($<span class="stringliteral">&quot;AcUtilsException caught and logged in Program.initLastTransAsync{Environment.NewLine}{exc.Message}&quot;</span>);</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">catch</span> (Exception ecx)</div>
<div class="line">            {</div>
<div class="line">                AcDebug.Log($<span class="stringliteral">&quot;Exception caught and logged in Program.initLastTransAsync{Environment.NewLine}{ecx.Message}&quot;</span>);</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">return</span> ret;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Generate an Excel worksheet with the results in reverse chronological order so the most </span></div>
<div class="line">        <span class="comment">// recent activity in the repository is shown on top. Returns true if the operation completed </span></div>
<div class="line">        <span class="comment">// successfully, false otherwise. COMException caught and logged in </span></div>
<div class="line">        <span class="comment">// %LOCALAPPDATA%\AcTools\Logs\LatestTransactions-YYYY-MM-DD.log on worksheet creation failure.</span></div>
<div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> report()</div>
<div class="line">        {</div>
<div class="line">            Excel.Application excel = <span class="keyword">new</span> Excel.Application();</div>
<div class="line">            <span class="keywordflow">if</span> (excel == null)</div>
<div class="line">            {</div>
<div class="line">                MessageBox.Show(<span class="stringliteral">&quot;Excel installation not found.&quot;</span>, <span class="stringliteral">&quot;LatestTransactions&quot;</span>,</div>
<div class="line">                    MessageBoxButtons.OK, MessageBoxIcon.Hand);</div>
<div class="line">                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordtype">bool</span> ret = <span class="keyword">true</span>; <span class="comment">// assume success</span></div>
<div class="line">            excel.DisplayAlerts = <span class="keyword">false</span>; <span class="comment">// don&#39;t display the SaveAs dialog box</span></div>
<div class="line">            Excel.Workbook wbook = excel.Workbooks.Add();</div>
<div class="line">            Excel.Worksheet wsheet = (Excel.Worksheet)wbook.Worksheets.get_Item(1);</div>
<div class="line">            Excel.Range rheader = wsheet.get_Range(<span class="stringliteral">&quot;A1&quot;</span>, <span class="stringliteral">&quot;F1&quot;</span>);</div>
<div class="line">            rheader.Font.Bold = <span class="keyword">true</span>;</div>
<div class="line">            rheader.HorizontalAlignment = Excel.XlHAlign.xlHAlignCenter;</div>
<div class="line">            Excel.Range rdate = wsheet.get_Range(<span class="stringliteral">&quot;B:B&quot;</span>);</div>
<div class="line">            rdate.NumberFormat = <span class="stringliteral">&quot;mmm d, yyyy h:mm:ss am/pm&quot;</span>;</div>
<div class="line">            Excel.Range rcomment = wsheet.get_Range(<span class="stringliteral">&quot;F:F&quot;</span>);</div>
<div class="line">            rcomment.WrapText = <span class="keyword">true</span>;</div>
<div class="line"></div>
<div class="line">            wsheet.Cells[1, <span class="stringliteral">&quot;A&quot;</span>] = <span class="stringliteral">&quot;Depot&quot;</span>;</div>
<div class="line">            wsheet.Columns[<span class="stringliteral">&quot;A&quot;</span>].ColumnWidth = 20;</div>
<div class="line">            wsheet.Cells[1, <span class="stringliteral">&quot;B&quot;</span>] = <span class="stringliteral">&quot;Time&quot;</span>;</div>
<div class="line">            wsheet.Columns[<span class="stringliteral">&quot;B&quot;</span>].ColumnWidth = 25;</div>
<div class="line">            wsheet.Cells[1, <span class="stringliteral">&quot;C&quot;</span>] = <span class="stringliteral">&quot;Action&quot;</span>;</div>
<div class="line">            wsheet.Columns[<span class="stringliteral">&quot;C&quot;</span>].ColumnWidth = 15;</div>
<div class="line">            wsheet.Cells[1, <span class="stringliteral">&quot;D&quot;</span>] = <span class="stringliteral">&quot;User&quot;</span>;</div>
<div class="line">            wsheet.Columns[<span class="stringliteral">&quot;D&quot;</span>].ColumnWidth = 15;</div>
<div class="line">            wsheet.Cells[1, <span class="stringliteral">&quot;E&quot;</span>] = <span class="stringliteral">&quot;Trans_ID&quot;</span>;</div>
<div class="line">            wsheet.Columns[<span class="stringliteral">&quot;E&quot;</span>].ColumnWidth = 10;</div>
<div class="line">            wsheet.Cells[1, <span class="stringliteral">&quot;F&quot;</span>] = <span class="stringliteral">&quot;Comment&quot;</span>;</div>
<div class="line">            wsheet.Columns[<span class="stringliteral">&quot;F&quot;</span>].ColumnWidth = 50;</div>
<div class="line"></div>
<div class="line">            <span class="keywordtype">int</span> row = 2;</div>
<div class="line">            <span class="keywordflow">foreach</span> (XElement trans <span class="keywordflow">in</span> _transactions.OrderByDescending(n =&gt; n.acxTime(<span class="stringliteral">&quot;time&quot;</span>)))</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordtype">string</span> depot = trans.Annotation&lt;<span class="keywordtype">string</span>&gt;();</div>
<div class="line">                <span class="keywordtype">int</span> <span class="keywordtype">id</span> = (int)trans.Attribute(<span class="stringliteral">&quot;id&quot;</span>);</div>
<div class="line">                <span class="keywordtype">string</span> action = (string)trans.Attribute(<span class="stringliteral">&quot;type&quot;</span>);</div>
<div class="line">                DateTime? time = trans.acxTime(<span class="stringliteral">&quot;time&quot;</span>);</div>
<div class="line">                <span class="keywordtype">string</span> <a name="a0"></a><a class="code" href="group__acenum.html#ggaa9826c7afff7ad23871825b95a0a631baee11cbb19052e40b07aac0ca060c23ee">user</a> = (string)trans.Attribute(<span class="stringliteral">&quot;user&quot;</span>);</div>
<div class="line">                <span class="keywordtype">string</span> comment = trans.acxComment();</div>
<div class="line"></div>
<div class="line">                wsheet.Cells[row, <span class="stringliteral">&quot;A&quot;</span>] = depot;</div>
<div class="line">                wsheet.Cells[row, <span class="stringliteral">&quot;B&quot;</span>] = time;</div>
<div class="line">                wsheet.Cells[row, <span class="stringliteral">&quot;C&quot;</span>] = action;</div>
<div class="line">                wsheet.Cells[row, <span class="stringliteral">&quot;D&quot;</span>] = <a class="code" href="group__acenum.html#ggaa9826c7afff7ad23871825b95a0a631baee11cbb19052e40b07aac0ca060c23ee">user</a>;</div>
<div class="line">                wsheet.Cells[row, <span class="stringliteral">&quot;E&quot;</span>] = id;</div>
<div class="line">                wsheet.Cells[row, <span class="stringliteral">&quot;F&quot;</span>] = comment;</div>
<div class="line">                row++;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordtype">string</span> file = String.Empty;</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                file = Path.Combine(_fileLocation, _fileName);</div>
<div class="line">                wbook.SaveAs(Filename: file, ReadOnlyRecommended: <span class="keyword">true</span>);</div>
<div class="line">                wbook.Close();</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">catch</span> (COMException exc)</div>
<div class="line">            {</div>
<div class="line">                AcDebug.Log(exc.Message);</div>
<div class="line">                MessageBox.Show(exc.Message);</div>
<div class="line">                ret = <span class="keyword">false</span>;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">finally</span> { excel.Quit(); }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span> (ret)</div>
<div class="line">            {</div>
<div class="line">                MessageBox.Show($<span class="stringliteral">&quot;Latest transactions saved to {file}&quot;</span>, <span class="stringliteral">&quot;LatestTransactions&quot;</span>,</div>
<div class="line">                    MessageBoxButtons.OK, MessageBoxIcon.Information);</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">return</span> ret;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">// General program initialization routines. Returns true if initialization was successful, false otherwise.</span></div>
<div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> init()</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// initialize our logging support so we can log errors</span></div>
<div class="line">            <span class="keywordflow">if</span> (!AcDebug.initAcLogging())</div>
<div class="line">            {</div>
<div class="line">                Console.WriteLine(<span class="stringliteral">&quot;Logging support initialization failed.&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="comment">// save an unhandled exception in log file before program terminates</span></div>
<div class="line">            AppDomain.CurrentDomain.UnhandledException += <span class="keyword">new</span> UnhandledExceptionEventHandler(AcDebug.unhandledException);</div>
<div class="line"></div>
<div class="line">            <span class="comment">// ensure we&#39;re logged into AccuRev</span></div>
<div class="line">            Task&lt;string&gt; prncpl = AcQuery.getPrincipalAsync();</div>
<div class="line">            <span class="keywordflow">if</span> (String.IsNullOrEmpty(prncpl.Result))</div>
<div class="line">            {</div>
<div class="line">                AcDebug.Log($<span class="stringliteral">&quot;Not logged into AccuRev.{Environment.NewLine}Please login and try again.&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="comment">// initialize our class variables from LatestTransactions.exe.config</span></div>
<div class="line">            <span class="keywordflow">if</span> (!initAppConfigData()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"></div>
<div class="line">            <span class="comment">// list of all depot names in the repository</span></div>
<div class="line">            _depots = AcQuery.getDepotNameListAsync().Result;</div>
<div class="line">            <span class="keywordflow">if</span> (_depots == null) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Initialize our class variables from LatestTransactions.exe.config. Returns true if class variables </span></div>
<div class="line">        <span class="comment">// initialized successfully, false otherwise. ConfigurationErrorsException caught and logged in </span></div>
<div class="line">        <span class="comment">// %LOCALAPPDATA%\AcTools\Logs\LatestTransactions-YYYY-MM-DD.log on initialization failure.</span></div>
<div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> initAppConfigData()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">bool</span> ret = <span class="keyword">false</span>; <span class="comment">// assume failure</span></div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                _fileName = AcQuery.getAppConfigSetting&lt;<span class="keywordtype">string</span>&gt;(<span class="stringliteral">&quot;FileName&quot;</span>).Trim();</div>
<div class="line">                _fileLocation = AcQuery.getAppConfigSetting&lt;<span class="keywordtype">string</span>&gt;(<span class="stringliteral">&quot;FileLocation&quot;</span>).Trim();</div>
<div class="line">                ret = <span class="keyword">true</span>;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">catch</span> (ConfigurationErrorsException exc)</div>
<div class="line">            {</div>
<div class="line">                Process currentProcess = Process.GetCurrentProcess();</div>
<div class="line">                ProcessModule pm = currentProcess.MainModule;</div>
<div class="line">                AcDebug.Log($<span class="stringliteral">&quot;Invalid data in {pm.ModuleName}.config{Environment.NewLine}{exc.Message}&quot;</span>);</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">return</span> ret;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Sep 24 2018 06:59:15 for AcUtils by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
