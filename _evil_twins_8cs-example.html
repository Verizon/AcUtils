<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>AcUtils: EvilTwins.cs</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="Doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Verizon.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">AcUtils
   </div>
   <div id="projectbrief">A high performance abstraction layer for AccuRev</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="usergroup0.html"><span>Docs</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="group__acenum.html"><span>Enums</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">EvilTwins.cs</div>  </div>
</div><!--header-->
<div class="contents">
<p>When promoting elements to a stream, the error message <b><em>"...name already exists in backing stream..."</em></b> appears. What does this mean?</p>
<p>An element ID (EID) is an immutable unique identifier (number) assigned to the element when it is added to AccuRev. It allows AccuRev to keep track of the entire history of the element from the time it was first added to the depot should it undergo a name or location change, or made defunct. When two elements with the same name and location are added to the depot in disparate streams, when promoted up the stream hierarchy they will eventually collide. This situation is referred to as <em>"evil twins"</em>. The error message indicates there are two elements with the same name and location but with different EID's. To fix evil twins:</p>
<ol type="1">
<li>Since you must clear the namespace in one of the streams so the <em>"good twin"</em> prevails, you must decide which twin you want to keep. Use AccuRev's <a href="https://www.microfocus.com/documentation/accurev/72/WebHelp/wwhelp/wwhimpl/js/html/wwhelp.htm#href=AccuRev_OnLine_Help/online_help_F08_1.html">Version Browser</a> to view the history of each twin as this could impact your decision. For example, if one of the elements has gone to production and the other has not, you would want to make the production version the good twin and the other the evil twin.</li>
<li>If the element is a file, do a <code>diff</code> on the twins to make sure the good twin (the one that will prevail) has the correct content. Edit as needed.</li>
<li>Rename (<code>move</code>) the evil element and then <code>defunct</code> it. Note that as a best practice, renaming should always be done before making an element defunct, even in cases that are not evil twins (see Note below). In the case of evil twins, rename the evil twin with the ".EVIL" extension. Otherwise add a descriptive extension to the element, for example ".OBSOLETE".</li>
<li><code>Promote</code> the renamed-defunct evil twin. Then do one of the following steps, based on <em>a</em> or <em>b:</em> <ol type="a">
<li>If the good twin exists higher up in the stream's hierarchy:<ol type="i">
<li>When the bad twin was renamed, the good twin was inherited immediately and appeared in your workspace as <code>(missing)</code>. Right-click on the missing element, select <code>Populate</code> and select <em>Ok</em> to bring it into your workspace.</li>
</ol>
</li>
<li>If the good twin does not exist higher up in the stream hierarchy:<ol type="i">
<li>Use the <a href="https://www.microfocus.com/documentation/accurev/72/WebHelp/wwhelp/wwhimpl/js/html/wwhelp.htm#href=AccuRev_OnLine_Help/Change_Palette.html">Change Palette</a> to cross promote the good twin to your workspace.</li>
</ol>
</li>
</ol>
</li>
</ol>
<dl class="section note"><dt>Note</dt><dd>You CAN <code>promote</code> an element into a stream with the same name as another element as long as the element in the stream has <code>(defunct)(member)</code> status. In this case, the twin that is <code>(defunct)(member)</code> is made <code>(stranded)</code> thus allowing the promoted element with the same name to become the new active member in the stream. However, this can cause promotion problems later if a twin with the <code>(stranded)</code> element's EID exists higher up in the stream hierarchy. This would require promoting the <code>(stranded)</code> version before its twin can be promoted. The practice of renaming (<code>move</code>) elements before their <code>defunct-promote</code> operation helps alleviate this problem and is the reason for the recommendation in step 3 above.</dd></dl>
<p><em>Diff Against... File on Disk</em> is the only way to diff files that are evil twins. For example <code>diff -v Stream1\1 -V Stream2\1 \.\Dir\foo.java</code> fails since internally it's implemented using the <code>name -e</code> option and does not rely on depot-relative pathnames. This allows <code>diff</code> to operate on files that have undergone namespace changes but (sadly) fails in the case of evil twins. AccuRev defect 26192, RFE 26215, Salesforce 00044449.</p>
<dl class="section user"><dt>To locate:</dt><dd><code>EvilTwins.exe</code> scans for the presence of evil twins in <em>depots</em> listed in <code>EvilTwins.exe.config</code>. Add <em>depot</em> entries (case-sensitive) as needed. Program output is sent to <code>EvilTwinsFound-YYYY-MM-DD.log</code>, a daily log file created/updated in the same folder where <code>EvilTwins.exe</code> resides. The program's return value is <em>zero (0)</em> if it ran successfully or <em>one (1)</em> in the event of an exception or initialization failure. Program errors are sent to STDOUT and <a class="el" href="class_ac_utils_1_1_ac_debug.html#ab0f6db993371a8857b18b8545bcef24d">logged</a> in <code>%LOCALAPPDATA%\AcTools\Logs\EvilTwins-YYYY-MM-DD.log</code>.<br />
Optional: To handle erroneously reported evil twins (false positives) or to disregard those that will eventually resolve on their own, put them in the <em>TwinsExcludeFile</em> specified in <code>EvilTwins.exe.config</code> to keep them from being reported in the future. Empty lines are allowed in the exclude file and comments can be added by using the # sign as the first character of each comment line. The full path to the exclude file should be given as the value for key <em>TwinsExcludeFile</em> in <code>EvilTwins.exe.config</code>. (Do not change the key name <em>TwinsExcludeFile</em> to some other name, otherwise the program will malfunction.)</dd></dl>
<dl class="section user"><dt>EvilTwinsFound log file</dt><dd></dd></dl>
<p><small> </p><pre class="fragment">\.\Mobile\LogManager.h
  EID: 4872 on Wed May 24 9:28 AM
    NEPTUNE_DEV2 (backed)
      Size: 411, ModTime: 8/3/2016 6:29:57 PM {text}
      Real: NEPTUNE_DEV2_thomas\5, Virtual: NEPTUNE_MAINT2\5
    NEPTUNE_MAINT1 (backed)
      Size: 407, ModTime: 7/5/2016 10:32:41 AM {text}
      Real: NEPTUNE_MAINT1_barnyrd\3, Virtual: NEPTUNE_MAINT\4
    NEPTUNE_MAINT2 (member)
      Size: 411, ModTime: 8/3/2016 6:29:57 PM {text}
      Real: NEPTUNE_DEV2_thomas\5, Virtual: NEPTUNE_MAINT2\5

  EID: 4989 on Wed May 24 9:28 AM
    NEPTUNE (member)
      Size: 412, ModTime: 8/3/2016 5:41:36 PM {text}
      Real: NEPTUNE_UAT_robert\1, Virtual: NEPTUNE\3
    NEPTUNE_CC (backed)
      Size: 412, ModTime: 8/3/2016 5:41:36 PM {text}
      Real: NEPTUNE_UAT_robert\1, Virtual: NEPTUNE\3
...
</pre><p> </small></p>
<dl class="section user"><dt>EvilTwins.exe.config</dt><dd></dd></dl>
<div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;utf-8&quot;</span>?&gt;</div>
<div class="line">&lt;configuration&gt;</div>
<div class="line">  &lt;configSections&gt;</div>
<div class="line">    &lt;section name=<span class="stringliteral">&quot;Depots&quot;</span> type=<span class="stringliteral">&quot;AcUtils.DepotsSection, AcUtils, Version=1.6.4.0, Culture=neutral, PublicKeyToken=26470c2daf5c2e2f, processorArchitecture=MSIL&quot;</span> /&gt;</div>
<div class="line">  &lt;/configSections&gt;</div>
<div class="line">  &lt;Depots&gt;</div>
<div class="line">    &lt;depots&gt;</div>
<div class="line">      &lt;add <a class="code" href="namespace_ac_utils.html#ga40cba942bbed1ac998223575478e4d6fa6f13b876f224fb5d11c729c36a871540">depot</a>=<span class="stringliteral">&quot;MARS&quot;</span> /&gt;</div>
<div class="line">      &lt;add <a class="code" href="namespace_ac_utils.html#ga40cba942bbed1ac998223575478e4d6fa6f13b876f224fb5d11c729c36a871540">depot</a>=<span class="stringliteral">&quot;JUPITER&quot;</span> /&gt;</div>
<div class="line">      &lt;add <a class="code" href="namespace_ac_utils.html#ga40cba942bbed1ac998223575478e4d6fa6f13b876f224fb5d11c729c36a871540">depot</a>=<span class="stringliteral">&quot;NEPTUNE&quot;</span> /&gt;</div>
<div class="line">    &lt;/depots&gt;</div>
<div class="line">  &lt;/Depots&gt;</div>
<div class="line">  &lt;appSettings&gt;</div>
<div class="line">    &lt;add key=<span class="stringliteral">&quot;TwinsExcludeFile&quot;</span> value=<span class="stringliteral">&quot;C:\Bin\TwinsToIgnore.txt&quot;</span>/&gt;</div>
<div class="line">  &lt;/appSettings&gt;</div>
<div class="line">  &lt;system.diagnostics&gt;</div>
<div class="line">    &lt;assert assertuienabled=<span class="stringliteral">&quot;false&quot;</span>/&gt;</div>
<div class="line">    &lt;sources&gt;</div>
<div class="line">      &lt;source name=<span class="stringliteral">&quot;EvilTwins&quot;</span>&gt;</div>
<div class="line">        &lt;listeners&gt;</div>
<div class="line">          &lt;<span class="keyword">remove</span> name=<span class="stringliteral">&quot;Default&quot;</span>/&gt;</div>
<div class="line">          &lt;add name=<span class="stringliteral">&quot;AcLog&quot;</span> type=<span class="stringliteral">&quot;Microsoft.VisualBasic.Logging.FileLogTraceListener, Microsoft.VisualBasic, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL&quot;</span>/&gt;</div>
<div class="line">          &lt;add name=<span class="stringliteral">&quot;EvilTwinsFound&quot;</span> type=<span class="stringliteral">&quot;Microsoft.VisualBasic.Logging.FileLogTraceListener, Microsoft.VisualBasic, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL&quot;</span>/&gt;</div>
<div class="line">        &lt;/listeners&gt;</div>
<div class="line">      &lt;/source&gt;</div>
<div class="line">    &lt;/sources&gt;</div>
<div class="line">  &lt;/system.diagnostics&gt;</div>
<div class="line">  &lt;startup&gt;</div>
<div class="line">    &lt;supportedRuntime version=<span class="stringliteral">&quot;v4.0&quot;</span> sku=<span class="stringliteral">&quot;.NETFramework,Version=v4.6.1&quot;</span>/&gt;</div>
<div class="line">  &lt;/startup&gt;</div>
<div class="line">&lt;/configuration&gt;</div>
</div><!-- fragment --><p><small> </p><pre class="fragment"># TwinsExcludeFile TwinsToIgnore.txt
# These evil twins will resolve when promoted to the root stream.
\.\src\com\foo.java
\.\src\bar.c
...
</pre><p> </small></p>
<div class="fragment"><div class="line"><span class="comment">/* Copyright (C) 2017-2018 Verizon. All Rights Reserved.</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></div>
<div class="line"><span class="comment">you may not use this file except in compliance with the License.</span></div>
<div class="line"><span class="comment">You may obtain a copy of the License at</span></div>
<div class="line"><span class="comment">    http://www.apache.org/licenses/LICENSE-2.0</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">Unless required by applicable law or agreed to in writing, software</span></div>
<div class="line"><span class="comment">distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></div>
<div class="line"><span class="comment">WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div>
<div class="line"><span class="comment">See the License for the specific language governing permissions and</span></div>
<div class="line"><span class="comment">limitations under the License. */</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// Required references: AcUtils.dll, Microsoft.VisualBasic, System, System.configuration, System.Xml.Linq</span></div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Collections.Generic;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Configuration;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Diagnostics;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.IO;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Linq;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.<a class="code" href="namespace_system_1_1_threading.html">Threading</a>.<a class="code" href="namespace_system_1_1_threading_1_1_tasks.html">Tasks</a>;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Xml.Linq;</div>
<div class="line"><span class="keyword">using</span> Microsoft.VisualBasic.Logging;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespace_ac_utils.html">AcUtils</a>;</div>
<div class="line"></div>
<div class="line"><span class="keyword">namespace </span>EvilTwins</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Compare two AccuRev elements based on their depot-relative path (case-insensitive) and element ID.</span></div>
<div class="line">    <span class="keyword">public</span> <span class="keyword">struct </span>TwinEqualityComparer : IEqualityComparer&lt;Tuple&lt;string, int&gt;&gt; <span class="comment">// [element, EID]</span></div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">bool</span> Equals(Tuple&lt;string, int&gt; x, Tuple&lt;string, int&gt; y)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (Object.ReferenceEquals(x, y)) <span class="comment">// are the compared objects the same object?</span></div>
<div class="line">                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">            <span class="keywordflow">if</span> (Object.ReferenceEquals(x, null) || Object.ReferenceEquals(y, null)) <span class="comment">// are either of them null?</span></div>
<div class="line">                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"></div>
<div class="line">            <span class="keywordtype">bool</span> path = String.Equals(x.Item1.ToUpperInvariant(), y.Item1.ToUpperInvariant());</div>
<div class="line">            <span class="keywordtype">bool</span> eid = (x.Item2 == y.Item2);</div>
<div class="line">            <span class="keywordflow">return</span> (path &amp;&amp; eid);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">int</span> GetHashCode(Tuple&lt;string, int&gt; elem)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">int</span> path = elem.Item1.ToUpperInvariant().GetHashCode();</div>
<div class="line">            <span class="keywordflow">return</span> path ^ elem.Item2; <span class="comment">// path ^ EID</span></div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keyword">class </span>Program</div>
<div class="line">    {</div>
<div class="line"><span class="preprocessor">        #region class variables</span></div>
<div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">string</span> _twinsExcludeFile; <span class="comment">// optional TwinsExcludeFile specified in EvilTwins.exe.config</span></div>
<div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> List&lt;String&gt; _excludeList; <span class="comment">// list of elements from TwinsExcludeFile in depot-relative format</span></div>
<div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> DepotsCollection _selDepots; <span class="comment">// list of depots from EvilTwins.exe.config to query for evil twins</span></div>
<div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> Dictionary&lt;AcDepot, HashSet&lt;Tuple&lt;string, int&gt;&gt;&gt; _map; <span class="comment">// [element, EID] for all elements in all dynamic streams in depot</span></div>
<div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> TwinEqualityComparer _tcompare; <span class="comment">// help determine if two elements are evil</span></div>
<div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> FileLogTraceListener _tl; <span class="comment">// logging support for evil twins that are found</span></div>
<div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> readonly <span class="keywordtype">object</span> _locker = <span class="keyword">new</span> object(); <span class="comment">// token for lock keyword scope</span></div>
<div class="line"><span class="preprocessor">        #endregion</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">// Returns zero (0) if program ran successfully, otherwise </span></div>
<div class="line">        <span class="comment">// one (1) in the event of an exception or program initialization failure.</span></div>
<div class="line">        <span class="keyword">static</span> <span class="keywordtype">int</span> Main()</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// general program startup initialization</span></div>
<div class="line">            <span class="keywordflow">if</span> (!init()) <span class="keywordflow">return</span> 1;</div>
<div class="line"></div>
<div class="line">            <span class="comment">// if a TwinsExcludeFile was specified in EvilTwins.exe.config, </span></div>
<div class="line">            <span class="comment">// validate that it exists and retrieve its content</span></div>
<div class="line">            <span class="keywordflow">if</span> (!String.IsNullOrEmpty(_twinsExcludeFile))</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (!File.Exists(_twinsExcludeFile))</div>
<div class="line">                {</div>
<div class="line">                    AcDebug.Log($<span class="stringliteral">&quot;TwinsExcludeFile {_twinsExcludeFile} specified in EvilTwins.exe.config not found&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">return</span> 1;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                    _excludeList = getTwinsExcludeList();</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="comment">// all stream types in order to include workspace streams, include hidden (removed) streams</span></div>
<div class="line">            AcDepots depots = <span class="keyword">new</span> AcDepots(dynamicOnly: <span class="keyword">false</span>, includeHidden: <span class="keyword">true</span>);</div>
<div class="line">            Task&lt;bool&gt; dini = depots.initAsync(_selDepots);</div>
<div class="line">            <span class="keywordflow">if</span> (!dini.Result) <span class="keywordflow">return</span> 1;</div>
<div class="line"></div>
<div class="line">            _tcompare = <span class="keyword">new</span> TwinEqualityComparer();</div>
<div class="line">            _map = <span class="keyword">new</span> Dictionary&lt;AcDepot, HashSet&lt;Tuple&lt;string, int&gt;&gt;&gt;();</div>
<div class="line">            List&lt;Task&lt;bool&gt;&gt; tasks = <span class="keyword">new</span> List&lt;Task&lt;bool&gt;&gt;(depots.Count);</div>
<div class="line">            <span class="keywordflow">foreach</span> (AcDepot <a class="code" href="namespace_ac_utils.html#ga40cba942bbed1ac998223575478e4d6fa6f13b876f224fb5d11c729c36a871540">depot</a> <span class="keywordflow">in</span> depots)</div>
<div class="line">                tasks.Add(initMapAsync(depot));</div>
<div class="line"></div>
<div class="line">            Task&lt;bool[]&gt; arr = Task.WhenAll(tasks); <span class="comment">// finish running stat commands and initialization in parallel</span></div>
<div class="line">            <span class="keywordflow">if</span> (arr == null || arr.Result.Any(n =&gt; n == <span class="keyword">false</span>)) <span class="keywordflow">return</span> 1; <span class="comment">// check log file</span></div>
<div class="line"></div>
<div class="line">            Task&lt;bool&gt; r = reportAsync();</div>
<div class="line">            <span class="keywordflow">return</span> (r.Result) ? 0 : 1;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Initialize our dictionary class variable with [element, EID] for all elements in all dynamic streams in depot. </span></div>
<div class="line">        <span class="comment">// AcUtilsException caught and logged in %LOCALAPPDATA%\AcTools\Logs\EvilTwins-YYYY-MM-DD.log on stat command failure. </span></div>
<div class="line">        <span class="comment">// Exception caught and logged in same for a range of exceptions.</span></div>
<div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> async Task&lt;bool&gt; initMapAsync(AcDepot depot)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">bool</span> ret = <span class="keyword">false</span>; <span class="comment">// assume failure</span></div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                IEnumerable&lt;AcStream&gt; filter = <a name="a0"></a><a class="code" href="group__acenum.html#gga2149004df4de6f7f8763b1c46d4ade17ad98a07f84921b24ee30f86fd8cd85c3c">from</a> n in depot.Streams</div>
<div class="line">                                               where n.IsDynamic &amp;&amp; !n.Hidden</div>
<div class="line">                                               select n;</div>
<div class="line">                List&lt;Task&lt;AcResult&gt;&gt; tasks = <span class="keyword">new</span> List&lt;Task&lt;AcResult&gt;&gt;(filter.Count());</div>
<div class="line">                <span class="keywordflow">foreach</span> (AcStream <a name="a1"></a><a class="code" href="group__acenum.html#ggad7e684b07d7e19ab166efd38207cf884af7b44cfafd5c52223d5498196c8a2e7b">stream</a> <span class="keywordflow">in</span> filter)</div>
<div class="line">                    tasks.Add(AcCommand.runAsync($<span class="stringliteral">@&quot;stat -a -s &quot;&quot;{stream}&quot;&quot; -fx&quot;</span>)); <span class="comment">// -a for all elements in stream</span></div>
<div class="line"></div>
<div class="line">                AcResult[] arr = await Task.WhenAll(tasks); <span class="comment">// finish running stat commands in parallel</span></div>
<div class="line">                <span class="keywordflow">if</span> (arr != null &amp;&amp; arr.All(n =&gt; n.RetVal == 0)) <span class="comment">// true if all initialized successfully</span></div>
<div class="line">                {</div>
<div class="line">                    HashSet&lt;Tuple&lt;string, int&gt;&gt; hset = <span class="keyword">new</span> HashSet&lt;Tuple&lt;string, int&gt;&gt;(_tcompare);</div>
<div class="line">                    <span class="keywordflow">foreach</span> (AcResult r <span class="keywordflow">in</span> arr)</div>
<div class="line">                    {</div>
<div class="line">                        <span class="comment">// if empty the stream has an ACL that is preventing us from reading it or some other error occurred</span></div>
<div class="line">                        <span class="keywordflow">if</span> (r == null || String.IsNullOrEmpty(r.CmdResult)) <span class="keywordflow">continue</span>;</div>
<div class="line">                        XElement xml = XElement.Parse(r.CmdResult);</div>
<div class="line">                        <span class="keywordflow">foreach</span> (XElement e <span class="keywordflow">in</span> xml.Elements(<span class="stringliteral">&quot;element&quot;</span>))</div>
<div class="line">                        {</div>
<div class="line">                            <span class="keywordtype">string</span> path = (string)e.Attribute(<span class="stringliteral">&quot;location&quot;</span>);</div>
<div class="line">                            <span class="keywordtype">int</span> eid = (int)e.Attribute(<span class="stringliteral">&quot;id&quot;</span>);</div>
<div class="line">                            hset.Add(<span class="keyword">new</span> Tuple&lt;string, int&gt;(path, eid));</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line"></div>
<div class="line">                    lock (_locker) { _map.Add(depot, hset); }</div>
<div class="line">                    ret = <span class="keyword">true</span>; <span class="comment">// operation succeeded</span></div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">catch</span> (AcUtilsException ecx)</div>
<div class="line">            {</div>
<div class="line">                AcDebug.Log($<span class="stringliteral">&quot;AcUtilsException caught and logged in Program.initMapAsync{Environment.NewLine}{ecx.Message}&quot;</span>);</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">catch</span> (Exception ecx)</div>
<div class="line">            {</div>
<div class="line">                AcDebug.Log($<span class="stringliteral">&quot;Exception caught and logged in Program.initMapAsync{Environment.NewLine}{ecx.Message}&quot;</span>);</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">return</span> ret;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Report evil twins if found. Assumes the initMapAsync method has been called. Exception caught </span></div>
<div class="line">        <span class="comment">// and logged in %LOCALAPPDATA%\AcTools\Logs\EvilTwins-YYYY-MM-DD.log on operation failure.</span></div>
<div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> async Task&lt;bool&gt; reportAsync()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">bool</span> ret = <span class="keyword">false</span>; <span class="comment">// assume failure</span></div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">foreach</span> (KeyValuePair&lt;AcDepot, HashSet&lt;Tuple&lt;string, int&gt;&gt;&gt; pair <span class="keywordflow">in</span> _map.OrderBy(n =&gt; n.Key)) <span class="comment">// order by AcDepot</span></div>
<div class="line">                {</div>
<div class="line">                    AcDepot depot = pair.Key; <span class="comment">// depot</span></div>
<div class="line">                    HashSet&lt;Tuple&lt;string, int&gt;&gt; hset = pair.Value; <span class="comment">// [element, EID] from all dynamic streams in depot</span></div>
<div class="line">                    <span class="comment">// from our hashset create a collection of elements mapped to their EID&#39;s</span></div>
<div class="line">                    Lookup&lt;string, Tuple&lt;string, int&gt;&gt; col = (Lookup&lt;string, Tuple&lt;string, int&gt;&gt;)hset.ToLookup(n =&gt; n.Item1);</div>
<div class="line">                    <span class="comment">// where more than one EID exists for the element, order by element</span></div>
<div class="line">                    <span class="keywordflow">foreach</span> (var ii <span class="keywordflow">in</span> col.Where(n =&gt; n.Count() &gt; 1).OrderBy(n =&gt; n.Key))</div>
<div class="line">                    {</div>
<div class="line">                        <span class="keywordtype">string</span> element = ii.Key;</div>
<div class="line">                        <span class="keywordflow">if</span> (_excludeList != null &amp;&amp; _excludeList.Contains(element))</div>
<div class="line">                            <span class="keywordflow">continue</span>; <span class="comment">// ignore if in TwinsExcludeFile</span></div>
<div class="line"></div>
<div class="line">                        log(element);</div>
<div class="line">                        IEnumerable&lt;AcStream&gt; filter = <a class="code" href="group__acenum.html#gga2149004df4de6f7f8763b1c46d4ade17ad98a07f84921b24ee30f86fd8cd85c3c">from</a> n in depot.Streams</div>
<div class="line">                                                       where n.IsDynamic &amp;&amp; !n.Hidden</div>
<div class="line">                                                       select n;</div>
<div class="line">                        List&lt;Task&lt;XElement&gt;&gt; tasks = <span class="keyword">new</span> List&lt;Task&lt;XElement&gt;&gt;(filter.Count());</div>
<div class="line">                        <span class="keywordflow">foreach</span> (AcStream <a class="code" href="group__acenum.html#ggad7e684b07d7e19ab166efd38207cf884af7b44cfafd5c52223d5498196c8a2e7b">stream</a> <span class="keywordflow">in</span> filter)</div>
<div class="line">                            tasks.Add(getElementInfoAsync(stream, element));</div>
<div class="line"></div>
<div class="line">                        XElement[] arr = await Task.WhenAll(tasks); <span class="comment">// finish running stat commands in parallel</span></div>
<div class="line">                        <span class="keywordflow">if</span> (arr != null &amp;&amp; arr.All(n =&gt; n != null)) <span class="comment">// true if all ran successfully</span></div>
<div class="line">                        {</div>
<div class="line">                            <span class="keywordflow">foreach</span> (Tuple&lt;string, int&gt; jj <span class="keywordflow">in</span> ii.OrderBy(n =&gt; n.Item2)) <span class="comment">// order twins by EID</span></div>
<div class="line">                            {</div>
<div class="line">                                <span class="keywordtype">int</span> eid = jj.Item2;</div>
<div class="line">                                log($<span class="stringliteral">&quot;\tEID: {eid} on {DateTime.Now.ToString(&quot;</span>ddd MMM d h:mm tt<span class="stringliteral">&quot;)}&quot;</span>);</div>
<div class="line">                                <span class="comment">// C# language short-circuit: the test for id equals eid isn&#39;t evaluated if status equals &quot;(no such elem)&quot;, </span></div>
<div class="line">                                <span class="comment">// otherwise an exception would be thrown since the id attribute doesn&#39;t exist in this case</span></div>
<div class="line">                                <span class="keywordflow">foreach</span> (XElement e <span class="keywordflow">in</span> arr.Where(n =&gt; (<span class="keywordtype">string</span>)n.Attribute(<span class="stringliteral">&quot;status&quot;</span>) != <span class="stringliteral">&quot;(no such elem)&quot;</span> &amp;&amp;</div>
<div class="line">                                    (int)n.Attribute(<span class="stringliteral">&quot;id&quot;</span>) == eid).OrderBy(n =&gt; n.Annotation&lt;AcStream&gt;()))</div>
<div class="line">                                {</div>
<div class="line">                                    log($<span class="stringliteral">&quot;\t\t{e.Annotation&lt;AcStream&gt;()} {(string)e.Attribute(&quot;</span>status<span class="stringliteral">&quot;)}&quot;</span>);</div>
<div class="line">                                    <span class="keywordtype">string</span> namedVersion = (string)e.Attribute(<span class="stringliteral">&quot;namedVersion&quot;</span>); <span class="comment">// virtual stream name and version number</span></div>
<div class="line">                                    <span class="keywordtype">string</span> temp = (string)e.Attribute(<span class="stringliteral">&quot;Real&quot;</span>);</div>
<div class="line">                                    <span class="keywordtype">string</span>[] real = temp.Split(<span class="charliteral">&#39;\\&#39;</span>); <span class="comment">// workspace stream and version numbers</span></div>
<div class="line">                                    AcStream wkspace = depot.getStream(<span class="keywordtype">int</span>.Parse(real[0])); <span class="comment">// workspace stream</span></div>
<div class="line">                                    <a name="a2"></a><a class="code" href="group__acenum.html#ga3164dabd0d78a5482aea218fa9154669">ElementType</a> elemType = e.acxType(<span class="stringliteral">&quot;elemType&quot;</span>);</div>
<div class="line">                                    <span class="keywordtype">string</span> twin;</div>
<div class="line">                                    <span class="keywordflow">if</span> ((<span class="keywordtype">long</span>?)e.Attribute(<span class="stringliteral">&quot;size&quot;</span>) != null)</div>
<div class="line">                                        twin = $<span class="stringliteral">&quot;\t\t\tSize: {(long)e.Attribute(&quot;</span>size<span class="stringliteral">&quot;)}, ModTime: {e.acxTime(&quot;</span>modTime<span class="stringliteral">&quot;)} {{{elemType}}}&quot;</span> +</div>
<div class="line">                                            $<span class="stringliteral">&quot;{Environment.NewLine}\t\t\tReal: {wkspace}\\{real[1]}, Virtual: {namedVersion}&quot;</span>;</div>
<div class="line">                                    <span class="keywordflow">else</span> <span class="comment">// a folder or link</span></div>
<div class="line">                                        twin = $<span class="stringliteral">&quot;\t\t\tReal: {wkspace}\\{real[1]}, Virtual: {namedVersion} {{{elemType}}}&quot;</span>;</div>
<div class="line"></div>
<div class="line">                                    log(twin);</div>
<div class="line">                                }</div>
<div class="line"></div>
<div class="line">                                log(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line">                            }</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                ret = <span class="keyword">true</span>; <span class="comment">// operation succeeded</span></div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">catch</span> (Exception ecx)</div>
<div class="line">            {</div>
<div class="line">                AcDebug.Log($<span class="stringliteral">&quot;Exception caught and logged in Program.reportAsync{Environment.NewLine}{ecx.Message}&quot;</span>);</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">return</span> ret;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Returns the attributes for the element in stream if the query succeeded, otherwise null. </span></div>
<div class="line">        <span class="comment">// AcUtilsException caught and logged in %LOCALAPPDATA%\AcTools\Logs\EvilTwins-YYYY-MM-DD.log on stat command failure. </span></div>
<div class="line">        <span class="comment">// Exception caught and logged in same for a range of exceptions.</span></div>
<div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> async Task&lt;XElement&gt; getElementInfoAsync(AcStream <a class="code" href="group__acenum.html#ggad7e684b07d7e19ab166efd38207cf884af7b44cfafd5c52223d5498196c8a2e7b">stream</a>, <span class="keywordtype">string</span> element)</div>
<div class="line">        {</div>
<div class="line">            XElement e = null;</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                AcResult r = await AcCommand.runAsync($<span class="stringliteral">@&quot;stat -fx -s &quot;&quot;{stream}&quot;&quot; &quot;&quot;{element}&quot;&quot;&quot;</span>);</div>
<div class="line">                <span class="keywordflow">if</span> (r != null &amp;&amp; r.RetVal == 0)</div>
<div class="line">                {</div>
<div class="line">                    XElement xml = XElement.Parse(r.CmdResult);</div>
<div class="line">                    e = xml.Element(<span class="stringliteral">&quot;element&quot;</span>);</div>
<div class="line">                    e.AddAnnotation(stream); <span class="comment">// add stream since it&#39;s not in the XML</span></div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">catch</span> (AcUtilsException ecx)</div>
<div class="line">            {</div>
<div class="line">                AcDebug.Log($<span class="stringliteral">&quot;AcUtilsException caught and logged in Program.getElementInfoAsync{Environment.NewLine}{ecx.Message}&quot;</span>);</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">catch</span> (Exception ecx)</div>
<div class="line">            {</div>
<div class="line">                AcDebug.Log($<span class="stringliteral">&quot;Exception caught and logged in Program.getElementInfoAsync{Environment.NewLine}{ecx.Message}&quot;</span>);</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">return</span> e;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Returns the list of elements in TwinsExcludeFile from EvilTwins.exe.config with elements that can be ignored. </span></div>
<div class="line">        <span class="comment">// Assumes caller has determined that the TwinsExcludeFile specified in EvilTwins.exe.config exists. </span></div>
<div class="line">        <span class="comment">// Exception caught and logged in %LOCALAPPDATA%\AcTools\Logs\EvilTwins-YYYY-MM-DD.log on operation failure.</span></div>
<div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> List&lt;String&gt; getTwinsExcludeList()</div>
<div class="line">        {</div>
<div class="line">            List&lt;String&gt; exclude = <span class="keyword">new</span> List&lt;String&gt;();</div>
<div class="line">            FileStream fs = null;</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// constructor arguments that avoid an exception thrown when file is in use by another process</span></div>
<div class="line">                fs = <span class="keyword">new</span> FileStream(_twinsExcludeFile, FileMode.Open, FileAccess.Read, FileShare.ReadWrite);</div>
<div class="line">                <span class="keyword">using</span> (StreamReader sr = <span class="keyword">new</span> StreamReader(fs))</div>
<div class="line">                {</div>
<div class="line">                    String line;</div>
<div class="line">                    <span class="keywordflow">while</span> ((line = sr.ReadLine()) != null)</div>
<div class="line">                    {</div>
<div class="line">                        <span class="keywordtype">string</span> temp = line.Trim();</div>
<div class="line">                        <span class="keywordflow">if</span> (temp.Length == 0 || temp.StartsWith(<span class="stringliteral">&quot;#&quot;</span>))</div>
<div class="line">                            <span class="keywordflow">continue</span>; <span class="comment">// this is an empty line or a comment</span></div>
<div class="line">                        exclude.Add(temp);</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">catch</span> (Exception ecx)</div>
<div class="line">            {</div>
<div class="line">                AcDebug.Log($<span class="stringliteral">&quot;Exception caught and logged in Program.getTwinsExcludeList{Environment.NewLine}{ecx.Message}&quot;</span>);</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">finally</span> <span class="comment">// avoids CA2202: Do not dispose objects multiple times</span></div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (fs != null) fs.Dispose();</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">return</span> exclude;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">// General program startup initialization routines.</span></div>
<div class="line">        <span class="comment">// Returns true if initialization was successful, false otherwise.</span></div>
<div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> init()</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// initialize logging support for reporting program errors</span></div>
<div class="line">            <span class="keywordflow">if</span> (!AcDebug.initAcLogging())</div>
<div class="line">            {</div>
<div class="line">                Console.WriteLine(<span class="stringliteral">&quot;Logging support initialization failed.&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="comment">// save an unhandled exception in log file before program terminates</span></div>
<div class="line">            AppDomain.CurrentDomain.UnhandledException += <span class="keyword">new</span> UnhandledExceptionEventHandler(AcDebug.unhandledException);</div>
<div class="line"></div>
<div class="line">            <span class="comment">// ensure we&#39;re logged into AccuRev</span></div>
<div class="line">            Task&lt;string&gt; prncpl = AcQuery.getPrincipalAsync();</div>
<div class="line">            <span class="keywordflow">if</span> (String.IsNullOrEmpty(prncpl.Result))</div>
<div class="line">            {</div>
<div class="line">                AcDebug.Log($<span class="stringliteral">&quot;Not logged into AccuRev.{Environment.NewLine}Please login and try again.&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="comment">// initialize our class variables from EvilTwins.exe.config</span></div>
<div class="line">            <span class="keywordflow">if</span> (!initAppConfigData()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">            <span class="comment">// initialize our logging support to log evil twins found</span></div>
<div class="line">            <span class="keywordflow">if</span> (!initEvilTwinsLogging()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Initialize our class variables from EvilTwins.exe.config.</span></div>
<div class="line">        <span class="comment">// Returns true if variables were successfully initialized, false otherwise.</span></div>
<div class="line">        <span class="comment">// ConfigurationErrorsException caught and logged in </span></div>
<div class="line">        <span class="comment">// %LOCALAPPDATA%\AcTools\Logs\EvilTwins-YYYY-MM-DD.log on initialization failure.</span></div>
<div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> initAppConfigData()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">bool</span> ret = <span class="keyword">true</span>; <span class="comment">// assume success</span></div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                _twinsExcludeFile = AcQuery.getAppConfigSetting&lt;<span class="keywordtype">string</span>&gt;(<span class="stringliteral">&quot;TwinsExcludeFile&quot;</span>).Trim();</div>
<div class="line">                DepotsSection depotsConfigSection = ConfigurationManager.GetSection(<span class="stringliteral">&quot;Depots&quot;</span>) as DepotsSection;</div>
<div class="line">                <span class="keywordflow">if</span> (depotsConfigSection == null)</div>
<div class="line">                {</div>
<div class="line">                    AcDebug.Log(<span class="stringliteral">&quot;Error in Program.initAppConfigData creating DepotsSection&quot;</span>);</div>
<div class="line">                    ret = <span class="keyword">false</span>;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                    _selDepots = depotsConfigSection.Depots;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">catch</span> (ConfigurationErrorsException exc)</div>
<div class="line">            {</div>
<div class="line">                Process currentProcess = Process.GetCurrentProcess();</div>
<div class="line">                ProcessModule pm = currentProcess.MainModule;</div>
<div class="line">                AcDebug.Log($<span class="stringliteral">&quot;Invalid data in {pm.ModuleName}.config{Environment.NewLine}{exc.Message}&quot;</span>);</div>
<div class="line">                ret = <span class="keyword">false</span>;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">return</span> ret;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Initialize our logging support for evil twins found. Output is sent to the daily log file </span></div>
<div class="line">        <span class="comment">// EvilTwinsFound-YYYY-MM-DD.log created (or updated) in the same folder where EvilTwins.exe resides.</span></div>
<div class="line">        <span class="comment">// Returns true if logging was successfully initialized, false otherwise. Exception caught and logged in </span></div>
<div class="line">        <span class="comment">// %LOCALAPPDATA%\AcTools\Logs\EvilTwins-YYYY-MM-DD.log on initialization failure.</span></div>
<div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> initEvilTwinsLogging()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">bool</span> ret = <span class="keyword">false</span>; <span class="comment">// assume failure</span></div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                TraceSource ts = <span class="keyword">new</span> TraceSource(<span class="stringliteral">&quot;EvilTwins&quot;</span>); <span class="comment">// this program name</span></div>
<div class="line">                _tl = (FileLogTraceListener)ts.Listeners[<span class="stringliteral">&quot;EvilTwinsFound&quot;</span>];</div>
<div class="line">                _tl.Location = LogFileLocation.ExecutableDirectory; <span class="comment">// create the log file in the same folder as our executable</span></div>
<div class="line">                _tl.BaseFileName = <span class="stringliteral">&quot;EvilTwinsFound&quot;</span>; <span class="comment">// our log file name begins with this name</span></div>
<div class="line">                _tl.MaxFileSize = 83886080; <span class="comment">// log file can grow to a maximum of 80 megabytes in size</span></div>
<div class="line">                _tl.ReserveDiskSpace = 2500000000; <span class="comment">// at least 2.3GB free disk space must exist for logging to continue</span></div>
<div class="line">                <span class="comment">// append -YYYY-MM-DD to the log file name</span></div>
<div class="line">                <span class="comment">// additional runs of this app in the same day append to this file (by default)</span></div>
<div class="line">                _tl.LogFileCreationSchedule = LogFileCreationScheduleOption.Daily;</div>
<div class="line">                _tl.AutoFlush = <span class="keyword">true</span>; <span class="comment">// true to make sure we capture data in the event of an exception</span></div>
<div class="line">                ret = <span class="keyword">true</span>;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">catch</span> (Exception exc)</div>
<div class="line">            {</div>
<div class="line">                AcDebug.Log($<span class="stringliteral">&quot;Exception caught and logged in Program.initEvilTwinsLogging{Environment.NewLine}{exc.Message}&quot;</span>);</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">return</span> ret;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Write text to the EvilTwinsFound-YYYY-MM-DD.log daily log file located in the same folder where EvilTwins.exe resides.</span></div>
<div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">void</span> log(<span class="keywordtype">string</span> <a name="a3"></a><a class="code" href="group__acenum.html#gga3164dabd0d78a5482aea218fa9154669a1cb251ec0d568de6a929b520c4aed8d1">text</a>)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (_tl != null)</div>
<div class="line">                _tl.WriteLine(text);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Sep 20 2018 16:04:49 for AcUtils by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
